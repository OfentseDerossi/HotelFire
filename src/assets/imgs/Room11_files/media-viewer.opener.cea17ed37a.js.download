($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/media-viewer.opener",d:["vendor-babel","vendor-react-libs","vendor-apollo-libs","vendor-redux-libs","ta-platform","@ta/events.keyboard-event-listener","@ta/media-viewer.hash-utils","ta-common","@ta/media-viewer.types","@ta/media-viewer.tracking","@ta/hotels.media-album-parts"],e:["./packages/media-viewer/opener/index.jsx"],x:{"./packages/media-viewer/opener/index.jsx":["MVOpener","openMediaViewer"]},m:{"./packages/media-viewer/opener/index.jsx":function(e,n,t){"use strict";t.r(n);var a=t("@babel/runtime/helpers/esm/slicedToArray"),r=t.n(a),i=t("@babel/runtime/helpers/esm/objectSpread"),d=t.n(i),o=t("react"),u=t("react-apollo"),c=t("react-redux"),l=t("@ta/common.radio"),s=t.n(l),m=t("@ta/events.keyboard-event-listener"),p=t.n(m),f=t("@ta/media-viewer.hash-utils"),v=t("@ta/media.common"),I=t("@ta/media-viewer.types"),A=t("@ta/media-viewer.tracking"),y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"MVLocationQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locationIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"locationId"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:100}};y.loc.source={body:"5f4434f4d616"};var b=y,E=function e(){return I.mediaGroupIds[Object(I.getMediaGroupForString)(Object(v.getMediaFilterToRetrieveAllPhotos)().mediaGroup)]},M=function e(n,t){switch(t.type){case"ALBUM":return d()({},n,{albumId:t.albumId,typeId:E(),categoryId:t.albumId,media:void 0,referenceCompoundMediaId:void 0,referenceGalleryIndex:void 0});case"CATEGORY":return d()({},n,{categoryId:t.categoryId,referenceCompoundMediaId:void 0,media:void 0,referenceGalleryIndex:void 0});case"TYPE":return d()({},n,{typeId:t.typeId,referenceCompoundMediaId:void 0,media:void 0,referenceGalleryIndex:void 0});case"DETAIL":return d()({},n,{selectedIndex:t.selectedIndex,media:t.media,referenceGalleryIndex:t.referenceGalleryIndex?t.referenceGalleryIndex:n.referenceGalleryIndex});case"UPDATE_MEDIA":return d()({},n,{selectedIndex:t.selectedIndex,media:t.media});case"UPDATE_MEDIA_OBJECT":return d()({},n,{media:t.media});case"UPDATE_LOCATION_NAME":return d()({},n,{locationName:t.locationName});case"GALLERY":return d()({},n,{media:void 0,referenceCompoundMediaId:void 0});case"OPEN":return d()({},n,t.state);default:return n}},w=function e(n){var t=n.renderMediaViewer,a=n.locationId,i=n.locationName,u=o.useState(!1),c=r()(u,2),l=c[0],m=c[1],v=o.useState(""),I=r()(v,2),y=I[0],b=I[1],E=f.getMediaViewerState(),w=o.useReducer(M,d()({},E,{referenceCompoundMediaId:E.referenceCompoundMediaId,locationId:a})),L=r()(w,2),T=L[0],h=L[1],g=o.useRef(s()("media-viewer")),k=o.useRef(!1);if(o.useEffect(function(){var e=function e(){return b(f.getHash())};return e(),window.addEventListener("popstate",e),window.addEventListener("hashchange",e),function(){window.removeEventListener("popstate",e),window.removeEventListener("hashchange",e)}},[]),o.useEffect(function(){return h({type:"UPDATE_LOCATION_NAME",locationName:i})},[i]),o.useEffect(function(){if(l){var e=f.generateUrlHashString(T);b(e),f.updateHash(T)}},[l,T]),l!==function e(n){return n.indexOf(f.hashRouteStart)>=0}(y)&&m(!l),function e(n){return n.indexOf(f.oldHashRouteStart)>=0}(y)){var O=f.initDefaults(f.generateMediaViewerStateFromPVRoute(y));O.locationId=a;var S=f.generateUrlHashString(O);b(S)}var N=o.useMemo(function(){return function(e){var n=f.initDefaults(e);n.referenceCompoundMediaId&&n.referenceCompoundMediaId.id<0&&(n.referenceCompoundMediaId=null),h({type:"OPEN",state:d()({locationId:a},n)});var t=f.generateUrlHashString(n);b(t),window.history.pushState(null,document.title,t),k.current=!0}}),V=o.useCallback(function(){k.current?(window.history.back(),k.current=!1):(f.removeHash(),b(f.getHash())),Object(A.trackEvent)(A.trackedPageActions.CLOSE_CLICK)}),_=o.useMemo(function(){return{close:V,mediaViewerState:T,dispatchMVAction:h}},[V,T,h]);return o.useEffect(function(){var e=g.current;return e.on("open",N),function(){return e.off("open",N)}},[N]),o.createElement(o.Fragment,null,l?t(_):null,o.createElement(p.a,{keyName:["Escape","Esc"],callback:V}))},L=o.memo(Object(c.connect)(function(e){return{locationId:e.page.detailId}})(function e(n){var t=n.renderMediaViewer,a=n.locationId;return o.createElement(u.Query,{query:b,variables:{locationId:a}},function(e){var n,r,i=e.loading,d=e.data;if(i||!d)return o.createElement(w,{renderMediaViewer:t,locationId:a,locationName:""});var u=null==d?void 0:null===(n=d.locations)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r.name;return o.createElement(w,{renderMediaViewer:t,locationId:a,locationName:u})})})),T=t("@ta/hotels.media-album-parts"),h=function e(n,t,a){var r=function e(n){if(!n)return T.AlbumTypes.ALL_ALBUMS;switch(n){case T.AlbumTypes.FAVORITE_PHOTOS:case T.AlbumTypes.HOTEL_AND_AMENITIES:case T.AlbumTypes.POOL_AND_BEACH:case T.AlbumTypes.ROOM_AND_SUITE_ALBUM:case T.AlbumTypes.VIDEO:case T.AlbumTypes.ALL_ALBUMS:return n;default:return T.AlbumTypes.ALL_ALBUMS}}(t),i=function e(n){if(!n)return T.AlbumTypes.ALL_ALBUMS;switch(n){case T.AlbumTypes.TRAVELER_ALBUM:return T.AlbumTypes.ALL_ALBUMS;default:return n}}(t),d=function e(n){var t=Object(I.getMediaGroupIdForString)(Object(v.getMediaFilterToRetrieveAllPhotos)().mediaGroup);if(!n)return t;switch(n){case T.AlbumTypes.TRAVELER_ALBUM:return I.mediaGroupIds.TRAVELER;default:return t}}(t),o=function e(n,t){if(!n||n<=0)return null;var a="p";return t===T.AlbumTypes.VIDEO&&(a="v"),t===T.AlbumTypes.PANO_ALBUM&&(a="pano"),{id:n,type:a}}(a,t);new s.a("media-viewer").emit("open",{locationId:n,albumId:r,categoryId:i,typeId:d,referenceCompoundMediaId:o})};t.d(n,"MVOpener",function(){return L}),t.d(n,"openMediaViewer",function(){return h})}}});
//# sourceMappingURL=media-viewer.opener.cea17ed37a.js.map