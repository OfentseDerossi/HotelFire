($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/hotels.hotel-review-persistent-header-and-footer",d:["vendor-babel","vendor-react-libs","vendor-redux-libs","lithium-platform","@ta/hotels.hotel-review-layout","ta-platform","@ta/hotels.hotel-offers","vendor-apollo-libs","ta-common","@ta/common.text","@ta/hotels.trip-search-standard","@ta/hotels.trip-search-compact","@ta/hotels.trip-search-tap-first","@ta/overlays.pieces"],e:["./packages/hotels/hotel-review-persistent-header-and-footer/PersistentHeaderAndFooter.jsx"],x:{"./packages/hotels/hotel-review-persistent-header-and-footer/PersistentHeaderAndFooter.jsx":["default"]},m:{"./packages/hotels/hotel-review-persistent-header-and-footer/PersistentHeaderAndFooter.jsx":function(e,t,r){"use strict";r.r(t);var o=r("@babel/runtime/helpers/esm/slicedToArray"),a=r.n(o),n=r("react"),i=r.n(n),l=r("react-redux"),s=r("@ta/platform.import"),c=r("@ta/hotels.hotel-review-layout"),d=r("@ta/common.classnames"),f=r.n(d),_=r("@ta/common.tracking"),u=r.n(_),h=r("@ta/common.features"),m=r("@ta/events.window-scroll"),p=r.n(m),b=r("@ta/hotels.hotel-offers"),v=r("@babel/runtime/helpers/esm/classCallCheck"),E=r.n(v),k=r("@babel/runtime/helpers/esm/createClass"),O=r.n(k),w=r("@babel/runtime/helpers/esm/possibleConstructorReturn"),g=r.n(w),T=r("@babel/runtime/helpers/esm/getPrototypeOf"),N=r.n(T),I=r("@babel/runtime/helpers/esm/inherits"),A=r.n(I),S=r("@babel/runtime/helpers/esm/assertThisInitialized"),y=r.n(S),C=r("@babel/runtime/helpers/esm/defineProperty"),j=r.n(C),D=r("@ta/common.i18n"),L=r("@ta/common.text"),F=90,B="persistentheader",P="click";function x(e){switch(e){case"TOP":return"top";case"NEARBY":return"location";case"ABOUT_TAB":return"about";default:return e.toLowerCase()}}function H(e){u()({module:B,action:P,context:x(e)}),"TOP"===e&&window.scrollTo({top:0,behavior:"smooth"});var t=document.getElementById(e);if(t){var r=t.getBoundingClientRect(),o=window.pageYOffset;window.scrollTo({top:r.top+o-F,behavior:"smooth"})}}function M(){var e=window&&window.require;e&&e.defined("ta/Core/TA.Event")&&e(["ta/Core/TA.Event"],function(e){e&&e.on("TabHeaderWC_clickTab",H)})}function U(){var e=window&&window.require;e&&e.defined("ta/Core/TA.Event")&&e(["ta/Core/TA.Event"],function(e){e&&e.off("TabHeaderWC_clickTab",H)})}var R=H,G=function e(t){var r=t.sectionId,o=t.innerRef,a=t.current,i=Object(L.unescapeHtml)(function l(e){switch(e){case"TOP":return Object(D.localize)("tabs_photos_fffff660");case"REVIEWS":return Object(D.localize)("tabs_reviews_fffff660");case"LOCATION":return Object(D.localize)("tabs_nearby_title_2_fffff660");case"ABOUT_TAB":return Object(D.localize)("hr_btf_about_header");default:return e}}(r));return n.createElement("div",{ref:o,key:r,onClick:function e(){return R(r)},className:f()("hotels-hotel-review-persistent-header-and-footer-Tab__tab--2xcfU",a?"hotels-hotel-review-persistent-header-and-footer-Tab__current--3GGvr":"")},n.createElement("span",{className:"hotels-hotel-review-persistent-header-and-footer-Tab__tab_title--2z4V3",title:i},i))};G.defaultProps={innerRef:function e(){}};var z=G,W=r("react-apollo"),V={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ListPivotQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locationIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"locationId"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"accommodationCategory"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"popIndexDetails"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"popIndexTotal"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"overviewUrl"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:234}};V.loc.source={body:"4319101b42a2"};var K,Y,q=V,Q={loading:!1,hotelName:"",category:"HOTEL",parentName:"",listUrl:"",hotelCount:0},X=n.createContext(Q),$=Object(l.connect)(function(e){return{locationId:e.page.detailId}})(function e(t){var r=t.locationId,o=t.children;return n.createElement(W.Query,{query:q,variables:{locationId:r},skip:!r||r<=0,errorPolicy:"all"},function(e){var t,r=e.loading,a=e.data;if(!r&&a&&a.locations&&a.locations[0]){var i,l,s=a.locations[0];t={loading:!1,hotelName:s.name||"",category:s.accommodationCategory||"HOTEL",parentName:(null===(i=s.parent)||void 0===i?void 0:i.name)||"",listUrl:s.overviewUrl||"",hotelCount:(null===(l=s.popIndexDetails)||void 0===l?void 0:l.popIndexTotal)||0}}else t=Q;return n.createElement(X.Provider,{value:t},o)})}),Z=function e(){var t=n.useContext(X),r=t.hotelName;return t.loading||!r?null:n.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-HotelName__name--3MgG_",onClick:function e(){R("TOP")}},n.createElement("span",{className:"hotels-hotel-review-persistent-header-and-footer-HotelName__truncate--ku_oP"},r))},J=150,ee=function(e){function t(e){var r;return E()(this,t),r=g()(this,N()(t).call(this,e)),j()(y()(y()(r)),"onScroll",function(){if(r.props.tabSectionIds&&r.props.tabSectionIds[0]){var e=r.props.tabSectionIds.reduce(function(e,t){var r=document.getElementById(t);return r?r.getBoundingClientRect().top-J>0?e:t:e},r.state.current);r.state.current!==e&&r.setState({current:e})}else r.state.current&&r.setState({current:null})}),r.state={current:"ABOUT_TAB"},r}return A()(t,e),O()(t,[{key:"componentDidMount",value:function e(){M()}},{key:"componentWillUnmount",value:function e(){U()}},{key:"render",value:function e(){var t=this.state.current;return n.createElement("div",{className:f()("ui_container","hotels-hotel-review-persistent-header-and-footer-Tabs__tab_bar_content_container--1tD5K")},"DESKTOP"===this.props.viewport&&n.createElement(Z,null),n.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-Tabs__tabs--1G1aE"},this.props.tabSectionIds.map(function(e){return n.createElement(z,{key:e,sectionId:e,current:t===e})})),n.createElement("div",{className:"".concat("hotels-hotel-review-persistent-header-and-footer-TabsDesktop__commerce--3-tZq"," ").concat("hotels-hotel-review-persistent-header-and-footer-TabsDesktop__tabBarOffer--2vHD9")},Object(h.featureIsEnabled)("hr_datepicker_footer_dt_meta")?null:n.createElement(b.MiniOffer,{offer:this.props.metaOffer})),n.createElement(p.a,{callback:this.onScroll,throttle:250}))}}]),t}(n.PureComponent),te=150,re=["ABOUT_TAB","LOCATION","REVIEWS"],oe=function(e){function t(){var e;return E()(this,t),e=g()(this,N()(t).call(this)),j()(y()(y()(e)),"onScroll",function(){var t,r="ABOUT_TAB",o=document.getElementById("LOCATION");if(o){var a=o.getBoundingClientRect().top-te;a<=0&&(r="LOCATION",t=a)}var n=document.getElementById("REVIEWS");if(n){var i=n.getBoundingClientRect().top-te;i<=0&&(!t||i>t)&&(r="REVIEWS")}e.state.current!==r&&e.setState({current:r})}),e.state={current:"ABOUT_TAB"},e}return A()(t,e),O()(t,[{key:"componentDidMount",value:function e(){this.onScroll&&setTimeout(this.onScroll,0),M()}},{key:"componentWillUnmount",value:function e(){U()}},{key:"render",value:function e(){var t=this;return n.createElement("div",{className:f()("ui_container","hotels-hotel-review-persistent-header-and-footer-Tabs__tab_bar_content_container--1tD5K")},n.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-Tabs__tabs--1G1aE"},re.map(function(e){return n.createElement(z,{key:e,current:t.state.current===e,sectionId:e})})),n.createElement(p.a,{callback:this.onScroll,throttle:250}))}}]),t}(n.PureComponent),ae=r("@ta/styleguide.icon"),ne=function e(){var t=n.useContext(X),r=t.parentName,o=t.hotelCount,a=t.category,i=t.listUrl;return!t.loading&&r&&i?n.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-BackToList__backToList--z9Gon"},n.createElement("a",{href:i,className:"ui_container ".concat("hotels-hotel-review-persistent-header-and-footer-BackToList__link--181Kq"),onClick:function e(t){return Object(_.trackClick)(t,{module:"persistentheader",action:"click",context:"back_to_list",value:0})}},n.createElement(ae.Icon,{name:"arrow-left",className:"hotels-hotel-review-persistent-header-and-footer-BackToList__arrowIcon--35QwD"}),function e(t,r,o){var a;switch(o){case"BB":a=Object(D.localize)("mobile_lite_detail_header_bar_see_all_bedandbreakfasts",{0:t});break;case"OTHER":a=Object(D.localize)("mobile_detail_header_bar_seeall_speciality_lodging",{0:t});break;case"HOTEL":default:a=r>1?Object(D.localize)("mobile_see_all_x_hotels_in_y",{0:"".concat(r),1:t}):Object(D.localize)("hotelshortlist_see_all_in_geo_ffffedfd",{0:t})}return Object(D.unescaped)(a)}(r,o,a))):null},ie=r("@ta/common.api"),le=r("@ta/hotels.trip-search-standard"),se=r.n(le),ce=r("@ta/hotels.trip-search-compact"),de=r.n(ce),fe=r("@ta/hotels.trip-search-tap-first"),_e=r.n(fe),ue=r("@ta/overlays.pieces"),he=function e(){return Object(h.featureIsEnabled)("hr_datepicker_footer_std_tall")||Object(h.featureIsEnabled)("hr_datepicker_footer_std_short")||Object(h.featureIsEnabled)("hr_datepicker_footer_dt")||Object(h.featureIsEnabled)("hr_datepicker_footer_dt_meta")?se.a:Object(h.featureIsEnabled)("hr_datepicker_footer_compact")?de.a:Object(h.featureIsEnabled)("hr_datepicker_footer_tap_first")?_e.a:null}(),me=Object(ie.bind)(function(e,t){return he&&he.stage(e,t),function(){return{}}})(function e(t){var r=t.isMobile,o=t.metaOffer,l=Object(n.useState)(!1),s=a()(l,2),c=s[0],d=s[1];if(c||!he)return null;if(r){if(Object(h.featureIsEnabled)("hr_datepicker_footer_std_tall")||Object(h.featureIsEnabled)("hr_datepicker_footer_std_short"))return i.a.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__container--2HFfH"},i.a.createElement(ue.CloseX,{colorVariant:"TA_GREEN_DARK",close:function e(){return d(!0)}}),i.a.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__heading--2Az_x"},Object(D.localize)("lowest_prices_for")),i.a.createElement(he,{name:"hr_datepicker_pers_foot",isDetailPage:!0,noMargin:!0,popAbove:!0}));if(Object(h.featureIsEnabled)("hr_datepicker_footer_compact"))return i.a.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__container--2HFfH"},i.a.createElement(he,{name:"hr_datepicker_pers_foot"}));if(Object(h.featureIsEnabled)("hr_datepicker_footer_tap_first"))return i.a.createElement("div",{className:f()("hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__container--2HFfH","hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__short--25kcG")},i.a.createElement(he,{name:"hr_datepicker_pers_foot"}))}else{if(Object(h.featureIsEnabled)("hr_datepicker_footer_dt"))return i.a.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__container--2HFfH"},i.a.createElement("div",{className:f()("ui_container","hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__dt_container--1kouN")},i.a.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__heading--2Az_x"},Object(D.localize)("lowest_prices_for")),i.a.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__trip_search_container--2gX9L"},i.a.createElement(he,{name:"hr_datepicker_pers_foot",isDetailPage:!0,popAbove:!0}))));if(Object(h.featureIsEnabled)("hr_datepicker_footer_dt_meta"))return i.a.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__container--2HFfH"},i.a.createElement("div",{className:f()("ui_container","hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__dt_container--1kouN")},i.a.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__heading--2Az_x"},Object(D.localize)("lowest_prices_for")),i.a.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__trip_search_container--2gX9L"},i.a.createElement(he,{name:"hr_datepicker_pers_foot",isDetailPage:!0,popAbove:!0,limitWidth:!0})),i.a.createElement("div",{className:"hotels-hotel-review-persistent-header-and-footer-TripSearchFooter__mini_offer--1PktG"},i.a.createElement(b.MiniOffer,{offer:o}))))}return null}),pe={stagingProcs:[],ssrQueriesList:[],listingFields:["chevronOffers","textLinkOffers","hiddenOffers","noAvailabilityLink","parentGeoName"],offerFields:["data","providerLogoUrl","strikeThroughText","savePriceText","providerDisplayName","priceText","status"]};function be(e,t){var r=document.getElementById(e),o=document.getElementById(t);return r&&o?r.getBoundingClientRect().top>o.getBoundingClientRect().top?1:-1:0}K=Object(h.featureIsEnabled)("hr_datepicker_footer_std_tall")?s.component(((Y=function e(){return r.e("@ta/hotels.mobile-footer-offer-loadable")}).__PACKAGE__="@ta/hotels.hotel-review-persistent-header-and-footer",Y.__MODULE_ID__="@ta/hotels.mobile-footer-offer-loadable",Y.__MODULE_NAME__="@ta/hotels.mobile-footer-offer-loadable",Y.__BUNDLE_NAME__="@ta/hotels.mobile-footer-offer-loadable",Y.__GET_SYNC__=function(){return r.m["@ta/hotels.mobile-footer-offer-loadable"]?r("@ta/hotels.mobile-footer-offer-loadable"):null},Y.__IS_LOADED__=function(){return void 0!==r.m["@ta/hotels.mobile-footer-offer-loadable"]},Y)):Object(h.featureIsEnabled)("hr_datepicker_footer_std_short")||Object(h.featureIsEnabled)("hr_datepicker_footer_compact")||Object(h.featureIsEnabled)("hr_datepicker_footer_tap_first")?s.component(function(){var e=function e(){return r.e("@ta/hotels.mobile-footer-offer-short")};return e.__PACKAGE__="@ta/hotels.hotel-review-persistent-header-and-footer",e.__MODULE_ID__="@ta/hotels.mobile-footer-offer-short",e.__MODULE_NAME__="@ta/hotels.mobile-footer-offer-short",e.__BUNDLE_NAME__="@ta/hotels.mobile-footer-offer-short",e.__GET_SYNC__=function(){return r.m["@ta/hotels.mobile-footer-offer-short"]?r("@ta/hotels.mobile-footer-offer-short"):null},e.__IS_LOADED__=function(){return void 0!==r.m["@ta/hotels.mobile-footer-offer-short"]},e}()):s.component(function(){var e=function e(){return r.e("@ta/hotels.mobile-footer-offer")};return e.__PACKAGE__="@ta/hotels.hotel-review-persistent-header-and-footer",e.__MODULE_ID__="@ta/hotels.mobile-footer-offer",e.__MODULE_NAME__="@ta/hotels.mobile-footer-offer",e.__BUNDLE_NAME__="@ta/hotels.mobile-footer-offer",e.__GET_SYNC__=function(){return r.m["@ta/hotels.mobile-footer-offer"]?r("@ta/hotels.mobile-footer-offer"):null},e.__IS_LOADED__=function(){return void 0!==r.m["@ta/hotels.mobile-footer-offer"]},e}());var ve=Object(l.connect)(function(e){return{sectionIds:Object(c.sectionState)(e).sectionIds,viewportCategory:e.meta.device.viewportCategory}})(function e(t){var r="MOBILE"===t.viewportCategory,o=n.useState(!1),i=a()(o,2),l=i[0],s=i[1],c=n.useRef(null),d=n.useRef(0),_=n.useMemo(function(){return function e(t){return Object.keys(t).filter(function(e){return!!t[e]}).sort(be)}(t.sectionIds)},[t.sectionIds]),h=function e(){if(c.current&&c.current instanceof HTMLElement)if(l&&d.current>window.pageYOffset+90)s(!1);else if(!l){var t=c.current.getBoundingClientRect().top;t-90<=0&&(d.current=window.pageYOffset+t,s(!0),u()({module:"persistentheader",action:"in_view"}))}};n.useEffect(function(){h()},[_]);var m=t.metaListingData,v=Object(b.getTopOffer)(m);return n.createElement(n.Fragment,null,n.createElement("div",{ref:c}),n.createElement($,null,n.createElement("div",{className:f()("hotels-hotel-review-persistent-header-and-footer-PersistentHeaderAndFooter__tab_bar--31rm9",l?"hotels-hotel-review-persistent-header-and-footer-PersistentHeaderAndFooter__fixed--8x8LO":"","persistent_tabs_header")},n.createElement(ne,null),r?n.createElement(oe,null):n.createElement(ee,{tabSectionIds:_,metaOffer:v,viewport:t.viewportCategory}))),!l||Object(b.isNoCommerce)(m)?null:n.createElement("div",{className:f()("hotels-hotel-review-persistent-header-and-footer-PersistentHeaderAndFooter__ui_persistent_footer--1MGGe",l?"hotels-hotel-review-persistent-header-and-footer-PersistentHeaderAndFooter__fixed--8x8LO":"")},n.createElement(me,{isMobile:r,metaOffer:v}),r?n.createElement(K,{metaListingData:m}):null),n.createElement(p.a,{callback:h,throttle:100}))});pe.stagingProcs.push(function(e,t){return me.stage(e,t)}),t.default=Object(b.bindToHotelReview)(pe,Object(h.featureIsEnabled)("mobile_web_phone")?"resp_hr_persistent_footer":"resp_hr_tab_bar_offer",function(e){return n.createElement(ve,{metaListingData:e})})}}});
//# sourceMappingURL=hotels.hotel-review-persistent-header-and-footer.897deb0502.js.map