
<!-- saved from url=(3212)https://www.jscache.com/static/page_moniker/facebook_dat-v23577826995b.html#pixelType=PAGEVIEW&curLocId=15208415&geoId=312578&locPrices=345&tadomain=tripadvisor.co.za&reqUnique=adc70623c6f40727df003597b0f8013d07a1bfed&userUnique=63861a5ecd0cc93962b6725c52a9449103a0c880&fbUserUnique=8bfb07b5028f0dc04e26e38bee890b657f4884797cc5959438b9875e57ba7cec&locale=en_ZA&countryID=293740&ipCountryAbbrev=ZA&seqId=12&sessionId=DECA11002A2690C66B891B08FFDF8924&currency=ZAR&timestampIn=1567310400&timestampOut=1567396800&numNights=1&numRooms=1&roomNights=1&numAdults=2&numChildren=0&timezone=SAST&regionName=&cityName=Greater%20Johannesburg&stateOrCityName=Greater%20Johannesburg&countryName=South%20Africa&countryAbbrev=ZA&destinationName=Businessburg%20Hotel&locationType=Accommodation&nearestAirport=JNB&propId=15208415&propName=Businessburg%20Hotel&brandName=&stDest=Johannesburg%2CSouth+Africa&geoName=Johannesburg&geoParentId=1210028&geoParentName=Greater%20Johannesburg&locPrice1=345&loc1=15208415&productIds=[%22%22,%22d15208415enZA%22,%22312578enZA%22]&productIdsShort=,d15208415enZA,312578enZA&device=Desktop&fbDevice=1&device2=desktop&userGeo=1210028&siteType=d&trueServlet=Hotel_Review&genTrueServlet=Hotel_Review&fbTrueServlet=H&fbRetargetingType=1&servlet=Hotel_Review&geoFeedBucket=all&serverName=www.tripadvisor.co.za&puid=XVpiggoQLYYAATIdG18AAAA1&isMobileDevice=n&rtPath=www.tamgrt.com/RT&random=363995620&dmpAudienceIds=16258,16532,15541,15542,15191,15193,15338,15309,16062&taSplit=1&mcid=13091&fbChannel=-1&isOrganic=false&criteoDedup=0&tasource=OTH&geo=312578&isClickoutYN=no&isLoggedIn=N&securelyLoggedIn=N&stuid=NY1QkB0y0N63y69vo5rZs9kPwWq9AI3X06eG-MgPgW7SdhPZFedQnPfDk5hGxnXO&countryAlpha2=ZA&criteoPartnerId=20914&criteoAttractionPartnerId=30224&criteoHotelAcct=%5Ban%3Dweb-hotels-tripadvisor.com%26cn%3Dza%26ln%3Den%2Can%3Dweb-hotels-0-tripadvisor.com%26cn%3Dza%26ln%3Den%2Can%3Dweb-hotels-1-tripadvisor.com%26cn%3Dza%26ln%3Den%2Can%3Dweb-hotels-2-tripadvisor.com%26cn%3Dza%26ln%3Den%5D&flight_originid=&flight_destid=&flight_startdate=2019-09-02&flight_enddate=2019-09-09&dynx_itemid=null_null_20190902_20190909&flight_num_tix=1&numSeniors=0&attractionShoppingCartTotalPriceUSD=0.00&facebookuvm_v2UlbScore=0.4152891694946062&facebookuvm_v2UlbBucket=21&fbUlbMultiplier=0.2000682618320867&facebookUlbScore=0.44974233537589997&facebookUlbBucket=100&googleExperimentSegment=test&googleUlbScore=0.34816356000000004&googleUlbBucket=2&googleuvm_v2UlbBucket=2&googleuvm_v2UlbScore=0.146715032&UVMBESTSCORE=0.11&UVMSCOPE=UVM_V2&UVMSAVEABLE=0&googleuvm_v2.1UlbBucket=2&googleuvm_v2.1UlbScore=0.11462649053505002&googleuvm_v2.1UlbBucketParamName=uvm_display_desktop_bucket&googleuvm_complexUlbBucket=1&googleuvm_complexUlbScore=0.029734104871749878&criteoUlbScore=0.11462649053505002&criteoUlbBucket=2&criteoUlbScoreCurrent=0.11462649053505002&criteoUlbBucketCurrent=2&DBISCORE=0.030010153485910875&DBIFLAG=false&mofSlice=94&mofLastUpdated=20190819&refHost=cby.ai&smarterTravelPixelID=gqLWKHSnTxes4YmmtgWkqA&smarterTravelPixelDomain=p.smartertravel.com&isSTConversion=false&googleCRMId=2c750ad399254210ada23d81a928f31b06852ce1&rexSplit=t&NanigansTestSegment=0&is_default_dates=Yes&pixelName=facebook_dat_pixel -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
  <style type="text/css">iframe[src="https://6498008.fls.doubleclick.net/activityi;src=6498008;type=invmedia;cat=ta_tr00;u1=2;u2=312555;u3=306926;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=745518147?"],
img[src="https://cm.g.doubleclick.net/pixel?google_nid=sojern__adx_open_bidder_seat&google_hm=LU9vVOMguIwHJGfydt9ytA&google_cm&google_sc&sjrn_id=TRDElz2vNGNUFr2_qJDmZbxKowKp1vCpwwruNS3fu2Zc4N_mF61GGOjlugtREeUQ&sjrn_ula=390708013"],
img[src="https://ad.doubleclick.net/ddm/activity/src=5387546;type=sales;cat=tripa000;qty=1;cost=0;u1=;u4=;u5=;u6=2;u9=1;u10=Braamfontein;u11=ZA;u12=1;u13=;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;npa=;ord=[OrderID]"],
iframe[src="https://6498008.fls.doubleclick.net/activityi;src=6498008;type=invmedia;cat=ta_tr00;u1=2;u2=312578;u3=15208415;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=363995620?"]
{display:none !important;}</style></head>
  <body>
    <script src="./inferredEvents.js.download" async=""></script><script src="./666624680067334" async=""></script><script async="" src="./fbevents.js.download"></script><script type="text/javascript">
      // Pull params from URL (argdict maps keys to values or arrays of values)
      var argdict = {};
      var args = window.location.hash.substring(1).split("&");
      for (var i = 0; i < args.length; i++) {
        var pair = args[i].split("=");

        if (typeof argdict[pair[0]] === "undefined") {
          argdict[pair[0]] = pair[1];
        } else if (typeof argdict[pair[0]] === "string") {
          argdict[pair[0]] = [argdict[pair[0]], pair[1]];
        } else {
          argdict[pair[0]].push(pair[1]);
        }
      }

      var fbPixelName = 'ViewContent'
          , fbContentType = '["hotel","destination"]';
      if (argdict.pixelType === 'CLICKOUT') {
        fbPixelName = 'InitiateCheckout';
      } else if (argdict.trueServlet === 'Tourism' || argdict.trueServlet === 'MobileTourism') {
        fbPixelName = 'Search';
      } else if (argdict.pixelType === 'ENTER_DATES') {
        fbPixelName = 'EnterDates'
      }

      var applicationId = encodeURIComponent(250701451714610);      
      // event name for Dynamic Product Ads
      var eventName = encodeURIComponent(fbPixelName);
      var fbCategory = encodeURIComponent(argdict.fbTrueServlet);
      var fbDevice = encodeURIComponent(argdict.fbDevice);
      var fbDateIn = encodeURIComponent(argdict.fbDateIn);
      var fbDateOut = encodeURIComponent(argdict.fbDateOut);
      var geoId = encodeURIComponent(argdict.geoId);
      // if no property id, returns the geo's most popular property id if there is one
      var PropId = encodeURIComponent(argdict.propId ? argdict.propId : argdict.geoMostPop);
      var mcid = encodeURIComponent(argdict.mcid);
      var countryID = encodeURIComponent(argdict.countryID);
      var fbUserUnique = encodeURIComponent(argdict.fbUserUnique);
      var userUnique = encodeURIComponent(argdict.userUnique);
      var ulbBucket = encodeURIComponent(argdict.facebookUlbBucket);
      var ulbScore = encodeURIComponent(argdict.facebookUlbScore);
      var fbRegion = encodeURIComponent(argdict.regionName);
      var fbCity = encodeURIComponent(argdict.cityName);
      var fbCountry = encodeURIComponent(argdict.countryAbbrev);
      var fbDestinationName = encodeURIComponent(argdict.destinationName);
      var fbLocationType = encodeURIComponent(argdict.locationType);
      var fbRetargetingType = encodeURIComponent(argdict.fbRetargetingType);
      var fbUlbMultiplier = encodeURIComponent(argdict.fbUlbMultiplier);
      var dmpAudienceIds = encodeURIComponent(argdict.dmpAudienceIds);
      var sitePerfTestCode = argdict.sitePerfTestCode || '0';

      // Only one model will be calculated for each user - v2, v2.1, or complex
      var uvmV2Bucket;
      var uvmV2Score;
      if (argdict.hasOwnProperty('facebookuvm_complexUlbBucket') && argdict.hasOwnProperty('facebookuvm_complexUlbScore')) {
        uvmV2Bucket = argdict.facebookuvm_complexUlbBucket;
        uvmV2Score = argdict.facebookuvm_complexUlbScore;
      }
      else if (argdict.hasOwnProperty('facebookuvm_v2.1UlbBucket') && argdict.hasOwnProperty('facebookuvm_v2.1UlbScore')) {
        uvmV2Bucket = argdict['facebookuvm_v2.1UlbBucket'];
        uvmV2Score = argdict['facebookuvm_v2.1UlbScore'];
      }
      else {
        uvmV2Bucket = argdict.facebookuvm_v2UlbBucket;
        uvmV2Score = argdict.facebookuvm_v2UlbScore;
      }
      uvmV2Bucket = encodeURIComponent(uvmV2Bucket);
      uvmV2Score = encodeURIComponent(uvmV2Score);

      var dateIn;
      var dateOut;
      if (argdict.timezone !== undefined)
      {
        // Send checkin and checkout dates with time of midnight (actually 11:59pm to keep the date the same) and timezone of the hotel
        dateIn = argdict.dateIn + 'T23:59:59' + argdict.timezone;
        dateOut = argdict.dateOut + 'T23:59:59' + argdict.timezone;
      }
      else
      {
        dateIn = argdict.dateIn;
        dateOut = argdict.dateOut;
      }

      // product ids for Dynamic Product Ads. Currently returning a property product followed by a geo product to ensure the geo product is the last product fired
      var productIds = [];
      if (typeof argdict['loc1'] !== 'undefined') {
        // On Hotels page, loc1 is the top commerce hotel for the geo in the POS.
        // On properties page, loc1 is the actual hotel.
        // In all other pages(e.g. SmartDeals page), loc1 is the top pop hotel of the geo.
        productIds.push(encodeURIComponent('d' + argdict['loc1'] + argdict.locale.replace('_', '')));
      }
      productIds.push(encodeURIComponent(geoId + argdict.locale.replace('_' , '')));
      
      // The following code, except the hashed email logic, is copy pasted from facebook.
      !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
      n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
      document,'script','//connect.facebook.net/en_US/fbevents.js');
      
      // Note: Using a variable for the pixel id instead of passing it directly causes FB's pixel helper chrome plug-in to break
      if (typeof argdict['fbHEml'] !== 'undefined') {
        fbq('init', '666624680067334', {em: encodeURIComponent(argdict.fbHEml)});
      }
      else {
        fbq('init', '666624680067334');
      }

      //End of copy paste from facebook.

      // For obfuscated pixel key mapping, see FB_PIXEL_KEY_MAPPING in PageMoniker.java
      // These are used for Facebook DPA ad creation, do not modify without consulting vwang@ or om-fb@
      var params = {
        'application_id' : applicationId,
        'content_type' : fbContentType,
        'content_ids' : productIds,
        'region' : fbRegion,
        'city' : fbCity,
        'country' : fbCountry,
        'destination' : fbDestinationName,
        'types' : fbLocationType,
        'external_id': fbUserUnique,
        'FB1' : fbDateIn,           // fbCheckInDate
        'FB2' : fbDateOut,          // fbCheckOutDate
        'FB3' : geoId,              // destinationCode
        'FB4' : fbDevice,           // fbDevice
        'FB5' : countryID,          // IP country id
        'FB6' : sitePerfTestCode,   // testing alternate pixel loading
        'FB7' : mcid,               // mcid
        'FB8' : fbCategory,         // fbProductType
        'FB9' : PropId,             // propertyID
        'FB10': userUnique,         // userUnique - this is passed so Facebook can match users with data we provided in an offline file (5/13/15)
        'FB13': ulbBucket,          // User level bid bucket (UVM v1)
        'FB14': ulbScore,           // User level bid score (UVM v1)
        'FB17': fbRetargetingType,  // Retargeting type
        'FB18': fbUlbMultiplier,    // User level bid multiplier
        'FB27': uvmV2Bucket,        // ULB bucket for v2 (for testing)
        'FB28': uvmV2Score,         // ULB score for v2 (for testing)
        'FB29': dmpAudienceIds,     // The audience ids for the user according to our DMP
        'user_bucket': uvmV2Bucket  // Parameter for FB's new ULB product 
      };
      if (fbPixelName === 'InitiateCheckout') {
        // Use puid as conversion unique
        params.order_id = argdict.puid;
        params.deferred_id = userUnique;
        params.value = argdict.fbBrpc;
        params.currency = 'USD';
      }

      params.checkin_date = dateIn;
      params.checkout_date = dateOut;

      // for Dynamic Product Ads
      if (fbPixelName === 'EnterDates') {
        fbq('trackCustom', eventName, params);
      } else if (fbPixelName === 'InitiateCheckout') {
        // Event id is used to deduplicate with S2S events (must match "event_id" set in FBWebEventApiRequestGenerator)
        fbq('trackSingle', '666624680067334', eventName, params, {eventID: argdict.puid + fbPixelName});
      } else {
        fbq('track', eventName, params);
      }
    </script>
  

</body></html>