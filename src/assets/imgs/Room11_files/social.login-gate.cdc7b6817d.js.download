($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/social.login-gate",d:["vendor-babel","vendor-react-libs","vendor-redux-libs","lithium-platform","@ta/social.failover","vendor-apollo-libs","ta-platform","@ta/common.webview","@ta/tracking.interactions","@ta/overlays.fullscreen-overlay","@ta/overlays.managers","@ta/overlays.pieces","@ta/events.keyboard-event-listener"],e:["./packages/social/login-gate/index.jsx"],x:{"./packages/social/login-gate/AuthGated.jsx":["a"],"./packages/social/login-gate/index.jsx":["SocialLoginGate","MemberHardGate","TermsOfUseOverlay","SocialOpener","AuthGated","TermsOverlayQuery"]},m:{"./node_modules/webpack/buildin/global.js":function(e,n){var t;t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},"./packages/social/login-gate/AuthGated.jsx":function(e,n,t){"use strict";(function(e){var r=t("@babel/runtime/helpers/esm/objectSpread"),a=t.n(r),o=t("@babel/runtime/helpers/esm/classCallCheck"),l=t.n(o),i=t("@babel/runtime/helpers/esm/createClass"),s=t.n(i),c=t("@babel/runtime/helpers/esm/possibleConstructorReturn"),u=t.n(c),d=t("@babel/runtime/helpers/esm/getPrototypeOf"),m=t.n(d),f=t("@babel/runtime/helpers/esm/inherits"),p=t.n(f),v=t("@babel/runtime/helpers/esm/defineProperty"),g=t.n(v),y=t("react"),O=t("react-redux"),b=t("react-apollo"),h=t("@ta/common.routing"),k=t("@ta/common.webview"),E=t("@ta/tracking.interactions"),w=function(n){function t(){return l()(this,t),u()(this,m()(t).apply(this,arguments))}return p()(t,n),s()(t,[{key:"formatInteraction",value:function e(n){var t=this.props.tracking;return t?{variables:{interaction:g()({},t.source,g()({},n,a()({element:t.element},t.attributes||{})))}}:null}},{key:"renderInner",value:function n(t,r){var a=this.props,o=a.loggedInUserId,l=a.pid,i=a.flowOrigin,s=a.flow,c=a.extraQueryParams,u=a.onClose,d=a.children,m=a.closeX,f=a.closeOnDocClick,p=a.windowShadeOption;return d(function n(a){return new Promise(function(n){if(o)n();else if(k.NativeBridge.isNativeWebview())k.NativeBridge.showRegistration(!1);else{var d={flow:s||"CORE_COMBINED",pid:a||l||-1,userRequestedForce:!0,extraQueryParams:c||{},locationId:r||-1,onSuccess:function e(r){t("modalSuccess"),n(r)},onClose:u,closeX:m,closeOnDocClick:f,windowShadeOption:p};i&&(d.extraQueryParams.flowOrigin=i),e.require(["trjs!ta/registration/RegOverlay"],function(e){t("elementClick"),e.showRegOverlayByPageModel(null,null,window.require("page-model"),d)})}})},o)}},{key:"render",value:function e(){var n=this;return y.createElement(h.RouteConsumer,null,function(e){var t=e.route;return y.createElement(b.Mutation,{mutation:E.LogInteractionV4},function(e){return n.renderInner(function t(r){var a=n.formatInteraction(r);a&&e(a)},t.geo)})})}}]),t}(y.Component);g()(w,"defaultProps",{closeX:!0,closeOnDocClick:!0,windowShadeOption:"dark"}),n.a=Object(O.connect)(function(e){return{loggedInUserId:e.auth.loggedInUserId}})(w)}).call(this,t("./node_modules/webpack/buildin/global.js"))},"./packages/social/login-gate/index.jsx":function(e,n,t){"use strict";t.r(n);var r=t("@babel/runtime/helpers/esm/objectSpread"),a=t.n(r),o=t("@babel/runtime/helpers/esm/classCallCheck"),l=t.n(o),i=t("@babel/runtime/helpers/esm/createClass"),s=t.n(i),c=t("@babel/runtime/helpers/esm/possibleConstructorReturn"),u=t.n(c),d=t("@babel/runtime/helpers/esm/getPrototypeOf"),m=t.n(d),f=t("@babel/runtime/helpers/esm/inherits"),p=t.n(f),v=t("@babel/runtime/helpers/esm/assertThisInitialized"),g=t.n(v),y=t("@babel/runtime/helpers/esm/defineProperty"),O=t.n(y),b=t("react"),h=t("react-redux"),k=t("@ta/common.features"),E=t("@ta/social.failover"),w=t("./packages/social/login-gate/AuthGated.jsx"),S=t("react-apollo"),C=t("@ta/common.logging"),P=t.n(C),T=t("@ta/overlays.fullscreen-overlay"),R=t.n(T),U=t("@ta/overlays.managers"),_=t("@ta/overlays.pieces"),I=t("@ta/platform.import"),M={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TermsOverlay"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"insightProfile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uiCardsState"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"states"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"getTermOfUseAcceptanceInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accepted"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:167}};M.loc.source={body:"34460b78ddd8"};var j=M,x={position:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},N=Object(I.deferredImport)("@ta/social.confirm-username","ConfirmUsername"),F=function e(n){var t=n.onComplete,r=n.children;return b.createElement(S.Query,{query:j},function(e){var n=e.loading,a=e.data,o=e.error;if(n)return null;if(a){var l=a.getTermOfUseAcceptanceInfo&&a.getTermOfUseAcceptanceInfo.accepted,i=a.insightProfile&&a.insightProfile.uiCardsState;return l&&i&&function e(n){return n.states.find(function(e){return"ONBOARDING_CONFIRM_USER"===e.id&&"COMPLETED"===e.state})}(i)?(t(),null):r}return o&&P.a.warn("Error in SkipIfCompleted query: ".concat(o)),P.a.warn("TermsOfUseOverlay was shown due to lack of sufficient information or a query error."),r})},A=function e(n){var t=function e(t){return b.createElement("div",{className:"social-login-gate-TermsOfUseOverlay__container--2SESV"},b.createElement("div",{className:"social-login-gate-TermsOfUseOverlay__bodyContent--3eGDZ"},b.createElement(N,{onComplete:n.onComplete,closerForError:t,trackingModule:"Social_onboarding_gatedaction"})))},r=function e(){return b.createElement(U.Closer,null,function(e){var r=function t(){e(),n.onClose&&n.onClose()};return n.fullscreen?b.createElement(b.Fragment,null,b.createElement(R.a,null,t(r))):b.createElement(b.Fragment,null,b.createElement(_.BlockScroll,null),b.createElement(_.Backdrop,{close:function e(){}},b.createElement(_.Overlay,x,t(r))))})};return n.forceTermsOfUse?b.createElement(r,null):b.createElement(F,{onComplete:n.onComplete},b.createElement(r,null))};A.defaultProps={fullscreen:!1,onClose:void 0,forceTermsOfUse:!1};var B=Object(h.connect)(function(e,n){return{fullscreen:n.fullscreenAlways||"MOBILE"===e.meta.device.viewportCategory}})(A),D=t("@ta/events.keyboard-event-listener"),G=t.n(D),L={position:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},q=function e(n){var t=b.createElement("div",{className:"social-login-gate-ReadonlyMessageOverlay__container--1l9mx"},b.createElement("div",{className:"social-login-gate-ReadonlyMessageOverlay__bodyContent--1bBv0"},n.children),b.createElement(_.CloseX,{close:n.closer}));return n.fullscreen?b.createElement(b.Fragment,null,b.createElement(R.a,null,t)):b.createElement(b.Fragment,null,b.createElement(_.BlockScroll,null),b.createElement(_.Backdrop,{close:n.closer},b.createElement(_.Overlay,L,t),b.createElement(G.a,{keyName:"Escape",callback:n.closer})))};q.defaultProps={fullscreen:!1};var Q=Object(h.connect)(function(e,n){return{fullscreen:n.fullscreenAlways||"MOBILE"===e.meta.device.viewportCategory}})(q),X=function(e){function n(){var e,t;l()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=u()(this,(e=m()(n)).call.apply(e,[this].concat(a))),O()(g()(g()(t)),"state",{openTermsOfUseOverlay:!1,onSuccess:function e(){},forceTermsOfUse:!1,openReadonlyOverlay:!1}),O()(g()(g()(t)),"closeTermsOfUseOverlay",function(){t.setState({openTermsOfUseOverlay:!1,onSuccess:function e(){}})}),O()(g()(g()(t)),"openReadonlyOverlay",function(){t.setState({openReadonlyOverlay:!0})}),O()(g()(g()(t)),"closeReadonlyOverlay",function(){t.setState({openReadonlyOverlay:!1})}),t}return p()(n,e),s()(n,[{key:"render",value:function e(){var n=this,t=this.props,r=t.pid,o=t.flowOrigin,l=t.flow,i=t.children,s=t.onClose,c=t.onLoginSuccess,u=t.tracking,d=t.isReadonlyMode,m=t.extraRegParams;return b.createElement(w.a,{pid:r,flowOrigin:o,flow:l,extraQueryParams:a()({},m,{social:!0}),onClose:s,tracking:u},function(e,t){var r=d?function e(){return n.openReadonlyOverlay(),Promise.reject()}:Object(k.featureIsEnabled)("social_2018_login_gate")?function t(r){return e(r).then(function(e){c&&c();var t=e&&(e.hasCreatedMember||!e.hasAcceptedTermsOfUse);return e&&!t||Object(k.featureIsEnabled)("social_2018_login_gate_skip_terms_of_service")?Promise.resolve():new Promise(function(e){n.setState({openTermsOfUseOverlay:!0,forceTermsOfUse:t,onSuccess:function t(){e(),n.setState({openTermsOfUseOverlay:!1,onSuccess:function e(){}})}})})})}:function e(){return Promise.resolve()};return b.createElement(b.Fragment,null,i(r,t),n.state.openTermsOfUseOverlay&&b.createElement(B,{onComplete:n.state.onSuccess,forceTermsOfUse:n.state.forceTermsOfUse,onClose:n.closeTermsOfUseOverlay}),n.state.openReadonlyOverlay&&b.createElement(Q,{closer:n.closeReadonlyOverlay},b.createElement(E.FailoverMessage,null)))})}}]),n}(b.Component);O()(X,"defaultProps",{pid:-1,flowOrigin:void 0,flow:void 0,tracking:void 0,onLoginSuccess:void 0});var W=Object(h.connect)(function(e){return{isReadonlyMode:e.meta.readonlyMode}})(X),$=function(e){function n(){return l()(this,n),u()(this,m()(n).apply(this,arguments))}return p()(n,e),s()(n,[{key:"render",value:function e(){var n=this.props,t=n.pid,r=n.flowOrigin,a=n.flow,o=n.onLoginSuccess,l=n.tracking;return!this.props.isReadonlyMode&&b.createElement(w.a,{pid:t,flowOrigin:r,flow:a,tracking:l,closeX:!1,closeOnDocClick:!1,windowShadeOption:"light"},function(e){return e().then(function(){return o&&o(),Promise.resolve()}),b.createElement(b.Fragment,null)})}}]),n}(b.Component);O()($,"defaultProps",{pid:-1,flowOrigin:"join",flow:"MEMBER_GATE_COMBINED",tracking:void 0,onLoginSuccess:void 0});var H=Object(h.connect)(function(e){return{isReadonlyMode:e.meta.readonlyMode}})($),V=function e(n){var t=n.name,r=n.local,a=n.pid,o=n.children;return b.createElement(W,{pid:a},function(e){return b.createElement(U.Opener,{name:t,local:r},function(n,t){return o(function(){e().then(n)},t)})})};V.defaultProps={local:!1,pid:void 0};var z=V;t.d(n,"SocialLoginGate",function(){return W}),t.d(n,"MemberHardGate",function(){return H}),t.d(n,"TermsOfUseOverlay",function(){return B}),t.d(n,"SocialOpener",function(){return z}),t.d(n,"AuthGated",function(){return w.a}),t.d(n,"TermsOverlayQuery",function(){return j})}}});
//# sourceMappingURL=social.login-gate.cdc7b6817d.js.map