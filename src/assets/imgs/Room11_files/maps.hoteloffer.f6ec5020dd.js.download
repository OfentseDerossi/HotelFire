($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/maps.hoteloffer",d:["vendor-babel","vendor-react-libs","vendor-redux-libs","ta-platform","lithium-platform","@ta/common.page-dates","@ta/common.page-guests","@ta/common.memoize","@ta/common.text","ta-common","@ta/hotels.pricing","@ta/common.poller","@ta/maps.fetch"],e:["./packages/maps/hoteloffer/entrypoint.jsx"],x:{"./packages/maps/hoteloffer/entrypoint.jsx":["HotelOffer","DeferredHotelOffer"]},m:{"./packages/maps/hoteloffer/entrypoint.jsx":function(e,t,r){"use strict";r.r(t);var o=r("@babel/runtime/helpers/esm/objectSpread"),n=r.n(o),a=r("react"),s=r("react-redux"),i=r("@ta/common.tracking"),l=r("@ta/common.features"),c=r("@ta/common.page-dates"),f=r("@ta/common.page-guests"),m=r("@ta/common.memoize"),p=r("@ta/common.text"),u=r("@ta/styleguide.button"),g=r.n(u),_=r("@ta/styleguide.icon"),h=r("@ta/common.i18n"),d=r("@ta/hotels.pricing"),b=function e(t){var r=Object(d.findFirstOffer)(t.offers),o=Object(d.findWorstOffer)(t.offers),n=!!(o&&r&&.97*o.price>r.price);if(r){var s=Object(l.featureIsEnabled)("all_in_pricing_copy_test_3")&&t.nights>0&&t.guestInfo.rooms>0?h.globalize.formatCurrencyInteger(r.price/t.nights/t.guestInfo.rooms):h.globalize.formatCurrencyInteger(r.price),c=function e(o){t.preOfferClick&&t.preOfferClick(r),t.onOfferClick(o,r.offerClickToken),function e(t){t.stopPropagation()}(o)};return a.createElement("div",{className:"maps-hoteloffer-HotelOffer__container--ntAvP"},a.createElement("div",{className:"maps-hoteloffer-HotelOffer__leftContainer--3IKk_"},o&&n&&a.createElement(p.AutoResizer,{className:"maps-hoteloffer-HotelOffer__strikeThroughPrice--39MWQ",defaultFontSizePx:14,minFontSizePx:10},h.globalize.formatCurrencyInteger(o.price)),a.createElement("div",{onClick:c},a.createElement(p.AutoResizer,{className:"maps-hoteloffer-HotelOffer__price--1KSIO",defaultFontSizePx:t.priceSize,minFontSizePx:14},s),Object(l.featureIsEnabled)("all_in_pricing_copy_test_1")&&t.nights>1&&t.guestInfo.rooms>0&&a.createElement(p.AutoResizer,{className:"maps-hoteloffer-HotelOffer__pricing_mode_copy--3yQmm",defaultFontSizePx:12,minFontSizePx:10},Object(h.localize)("num_nights_for_cost",{nNumNights:t.nights,priceString:h.globalize.formatCurrencyInteger(r.price*t.nights*t.guestInfo.rooms)})),Object(l.featureIsEnabled)("all_in_pricing_copy_test_2")&&t.nights>0&&a.createElement("span",{className:"maps-hoteloffer-HotelOffer__pricing_mode_copy--3yQmm"},Object(h.localize)("for_num_nights",{nNumNights:t.nights})),Object(l.featureIsEnabled)("all_in_pricing_copy_test_3")&&t.nights>0&&a.createElement("span",{className:"maps-hoteloffer-HotelOffer__pricing_mode_copy--3yQmm"},Object(h.localize)("num_nights_for_cost",{nNumNights:t.nights,priceString:h.globalize.formatCurrencyInteger(r.price)}))),a.createElement("div",{className:"maps-hoteloffer-HotelOffer__vendorNameContainer--3f8ML",onClick:c},a.createElement("span",{className:"maps-hoteloffer-HotelOffer__vendorName--21NVV"},r.provider),!r.isInstantBook&&Object(l.featureIsEnabled)("wc_maps_hotel_cards_offsite_arrow")&&a.createElement(_.Icon,{name:"external-link-no-box",className:"maps-hoteloffer-HotelOffer__offsiteArrow--37Rrh"}))),a.createElement("div",{className:"maps-hoteloffer-HotelOffer__viewDealContainer--28Hc4"},a.createElement(i.ClickTracker,t.trackingProps,a.createElement(g.a,{size:"small",onClick:c},Object(h.localize)("view_deal")))))}var f=t.offers&&0===t.offers.length?Object(h.localize)("meta_ui_contact_hotel_c2b"):Object(h.localize)("no_availailability_from_partners");return a.createElement("div",{className:"maps-hoteloffer-HotelOffer__container--ntAvP"},a.createElement("span",{className:"maps-hoteloffer-HotelOffer__offerMessaging--NbMz-"},f))};b.defaultProps={offers:[],trackingProps:{module:"maps_hotel_offer",action:"commerce_click"},onOfferClick:function e(t,r){t.persist();var o=window.require;o&&o(["trjs!commerce/offerclick"],function(e){e.clickEvent(t.nativeEvent,t.currentTarget,r)})},preOfferClick:function e(){},nights:0,guestInfo:f.DEFAULT_GUEST_INFO,priceSize:20};var v=Object(m.memoizeLast)(c.decode),O=Object(m.memoizeLast)(f.decode),k=Object(s.connect)(function(e,t){var r=e&&e.travelerInfo&&e.travelerInfo.hotels||{},o=v(r.stayDates),a=o.startDate,s=o.endDate,i=a&&s&&new c.CalendarDate(a).daysTo(new c.CalendarDate(s))||0,l=O(r.guests);return n()({},t,{nights:i,guestInfo:l})})(b),I=r("@babel/runtime/helpers/esm/classCallCheck"),y=r.n(I),E=r("@babel/runtime/helpers/esm/createClass"),N=r.n(E),z=r("@babel/runtime/helpers/esm/possibleConstructorReturn"),C=r.n(z),P=r("@babel/runtime/helpers/esm/getPrototypeOf"),j=r.n(P),H=r("@babel/runtime/helpers/esm/inherits"),x=r.n(H),S=r("@babel/runtime/helpers/esm/assertThisInitialized"),D=r.n(S),w=r("@babel/runtime/helpers/esm/defineProperty"),F=r.n(w),T=r("@ta/common.poller"),q=r.n(T),A=r("@ta/styleguide.loading"),W=r("@ta/maps.fetch"),R=r.n(W),L=5,M=function(e){function t(){var e,r;y()(this,t);for(var o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];return r=C()(this,(e=j()(t)).call.apply(e,[this].concat(n))),F()(D()(D()(r)),"state",{requestNumber:1}),F()(D()(D()(r)),"poll",function(){r.setState({requestNumber:r.state.requestNumber+1})}),F()(D()(D()(r)),"parseData",function(e,t){if(e){var o=e.hotels,n=e.hacStatus,a=n&&(n.isHacComplete||n.hacPercentComplete>90);if(o&&1===o.length){var s=o[0];return{offers:s.offers&&s.offers.filter(function(e){return!!e.providerInfo}).map(function(e){return{offerClickToken:e.offerClickToken,price:e.price,status:e.status,provider:e.providerInfo.name,isInstantBook:e.providerInfo.isInstantBook}}),complete:a||r.state.requestNumber>=L}}}return{offers:[],complete:!!t}}),F()(D()(D()(r)),"renderWithResponse",function(e){var t,o=e.loading,n=e.data;return t=n&&(n.complete||Object(d.findFirstOffer)(n.offers||[]))?a.createElement(k,{offers:n.offers||[],trackingProps:r.props.trackingProps}):a.createElement("div",{style:{width:"100%"}},a.createElement(A.LoadingSpinner,{size:"small"})),a.createElement(a.Fragment,null,a.createElement(q.a,{loading:o,complete:!!n&&n.complete,requestNumber:r.state.requestNumber,poll:r.poll}),t)}),r}return x()(t,e),N()(t,[{key:"render",value:function e(){var t=this.props,r=t.locationId,o=t.stayDates,n=t.guestInfo,s=this.state.requestNumber,i=0===this.props.servlet.trim().length?"WebComponentMap":this.props.servlet;return a.createElement(R.a,{url:"/data/1.0/mapsEnrichment/hotel/".concat(r,"?rn=").concat(s,"&rc=").concat(i,"&stayDates=").concat(o,"&guestInfo=").concat(n),parser:this.parseData},this.renderWithResponse)}}]),t}(a.PureComponent);F()(M,"defaultProps",{trackingProps:{module:"deferred_hotel_offer",action:"commerce_click"}});var Q=Object(s.connect)(function(e,t){var r=e.travelerInfo&&e.travelerInfo.hotels,o="",n="";return r&&(o=r.stayDates,n=r.guests),{locationId:t.locationId,stayDates:o,servlet:e.route.page,guestInfo:n}})(M);r.d(t,"HotelOffer",function(){return k}),r.d(t,"DeferredHotelOffer",function(){return Q})}}});
//# sourceMappingURL=maps.hoteloffer.f6ec5020dd.js.map