($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/hotels.community-content-common",d:["vendor-react-libs","lithium-platform","@ta/hotels.hotel-review-layout","vendor-apollo-libs","ta-platform","@ta/hotels.hotel-draft-review","ta-common","vendor-redux-libs","@ta/common.cookie","@ta/overlays.popover","@ta/hotels.question-answer-parts","@ta/overlays.managers","@ta/styleguide.grouping-tabs","@ta/hotels.review-list-parts","vendor-babel","@ta/styleguide.skeleton"],e:["./packages/hotels/community-content-common/index.jsx"],x:{"./packages/hotels/community-content-common/index.jsx":["LowContentCTA","ContextualCTA","TabBarAboveHeader","createTabBarQueries","HEADER_SCROLL_OFFSET","H_R_CONTENT_COLLECTION_PID","QUESTION_FORM_MODAL_NAME","scrollIntoView","default"]},m:{"./packages/hotels/community-content-common/index.jsx":function(e,t,n){"use strict";n.r(t);var o=n("react"),a=n("@ta/common.classnames"),i=n.n(a),c=n("@ta/common.features"),l=n("@ta/hotels.hotel-review-layout"),r=n("react-apollo"),s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CommunityContent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locationIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"locationId"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parentGeoId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"writeUserReviewUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"topicsUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"postPhotosUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"currentUserOwnerStatus"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isValid"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"roomTipsCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"topicCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reviewSummary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:298}};s.loc.source={body:"c1c809123f75"};var u=s,m={loading:!0,writeUserReviewUrl:"",topicsUrl:"",postPhotosUrl:"",roomTipsCount:0,questionsCount:0,reviewsCount:0,hasNoContent:!1,isActiveOwner:!1,locationId:0,geoId:0},d=o.createContext(m),_=d.Consumer,b=d.Provider,v=function e(t){return{query:u,variables:{locationId:t},errorPolicy:"all",skip:!t||t<0}},f=function e(t){var n=t.locationId,a=t.children,i=v(n);return o.createElement(r.Query,{query:i.query,variables:i.variables,errorPolicy:i.errorPolicy,skip:i.skip},function(e){var t,n=e.loading,i=e.data;if(!n&&i&&i.locations&&i.locations[0]){var c,l,r=i.locations[0],s=r.topicCount||0,u=(null===(c=r.reviewSummary)||void 0===c?void 0:c.count)||0;t={loading:n,writeUserReviewUrl:r.writeUserReviewUrl||"",topicsUrl:r.topicsUrl||"",postPhotosUrl:r.postPhotosUrl||"",roomTipsCount:r.roomTipsCount||0,questionsCount:s,reviewsCount:u,hasNoContent:0===s&&0===u,isActiveOwner:(null===(l=r.currentUserOwnerStatus)||void 0===l?void 0:l.isValid)||!1,locationId:r.locationId,geoId:r.parentGeoId}}else t=m;return o.createElement(b,{value:t},a)})},p=n("@ta/common.i18n"),h=n("@ta/common.tracking"),C=n.n(h),w=n("@ta/hotels.hotel-draft-review"),k=n("react-redux"),E=n("@ta/common.cookie"),y=Object(k.connect)(function(e){return{cookieDomain:e.meta.cookieDomain}})(function e(t){var n=t.locationId,a=t.geoId,i=t.writeUserReviewUrl,c=t.className,l=t.pid,r=t.cookieDomain,s=t.onClick,u=t.children;if(n<=0||a<=0)return null;var m=i||"/UserReview-g".concat(a,"-d").concat(n);return o.createElement("a",{href:m,target:"_blank",className:c,onClick:function e(t){s&&s(t),l&&l>0&&Object(E.setPIDCookie)(l,r)}},u)}),g=n("@ta/styleguide.icon"),T=function e(t){return o.createElement("div",{className:i()("hotels-community-content-common-ContentCollectionCTA__CTAContainer--3wrMF","ui_column is-4")},o.createElement(g.Icon,{name:t.icon,className:"hotels-community-content-common-ContentCollectionCTA__icon--16mqp"}),o.createElement("div",{className:"hotels-community-content-common-ContentCollectionCTA__title--2vdMr"},t.title),o.createElement("div",{className:"hotels-community-content-common-ContentCollectionCTA__subtitle--3rzck"},t.subtitle),t.children("hotels-community-content-common-ContentCollectionCTA__button--27hOq"))},I=function e(){return o.createElement(_,null,function(e){var t=e.locationId,n=e.geoId,a=e.writeUserReviewUrl;return o.createElement(T,{icon:"pencil-paper",title:Object(p.localize)("hr_write_your_review"),subtitle:Object(p.localize)("hr_write_your_review_sub_title")},function(e){return o.createElement(w.DraftReviewConsumer,null,function(c){var l=c.hasDraftReview;return o.createElement(y,{locationId:t,geoId:n,writeUserReviewUrl:a,pid:we,className:i()("ui_button primary",e),onClick:function e(t){return Object(h.trackClick)(t,{module:"low_content_collection_cta_review",action:"start_submission",context:"POI|Hotel",dstServlet:"UserReviewEdit",value:0,once:!0})}},function e(t){return t?Object(p.localize)("hotel.review.finish.review_fffff216"):Object(p.localize)("hr_write_a_review")}(l))})})})},O=function e(t,n,o,a,i,c){t.preventDefault(),o<0||n<0||(Object(E.setPIDCookie)(i,c),Object(h.trackEventCookie)({module:a,action:"start_submission",context:"POI|Hotel",value:0,destinationUrl:"/PostPhotos"}),window.open("/PostPhotos-g".concat(n,"-d").concat(o)))},N=Object(k.connect)(function(e){return{cookieDomain:e.meta.cookieDomain}})(function e(t){return o.createElement(_,null,function(e){var n=e.geoId,a=e.locationId,c=e.postPhotosUrl;return o.createElement(T,{icon:"camera-fill",title:Object(p.localize)("hr_share_your_photo"),subtitle:Object(p.localize)("hr_share_your_photo_subtitle_period")},function(e){return o.createElement("a",{href:c,className:i()("ui_button primary",e),target:"_blank",onClick:function e(o){return O(o,n,a,"low_content_collection_cta_photo",we,t.cookieDomain)}},Object(p.localize)("hr_post_a_photo"))})})}),x=function e(){return o.createElement(_,null,function(e){var t=e.topicsUrl;return o.createElement(T,{icon:"forums",title:Object(p.localize)("hr_get_answers"),subtitle:Object(p.localize)("hr_get_answer_subtitle")},function(e){return o.createElement("a",{href:"".concat(t,"#AskQuestionForm"),target:"_blank",className:i()("ui_button primary",e),onClick:function e(t){Object(h.trackClick)(t,{module:"low_content_collection_cta_question",action:"start_submission",context:"POI|Hotel",value:0,once:!0})}},Object(p.localize)("hr_ask_a_question"))})})},R=function e(t){return o.createElement(f,{locationId:t.locationId},o.createElement(_,null,function(e){var n=e.loading,a=e.isActiveOwner,r=e.questionsCount,s=e.reviewsCount,u=e.roomTipsCount,m=5;switch(t.selectedTab){default:case"Reviews":m=s;break;case"Questions":m=r;break;case"RoomTips":m=u}return n||a||m>=5&&0!==s?null:o.createElement(l.Section,{testTarget:"low_content_cta",className:i()("ui_columns","hotels-community-content-common-LowContentCTA__row--3gHG-",0===s?"hotels-community-content-common-LowContentCTA__noReviews--1Hksy":"")},o.createElement(I,null),o.createElement(N,null),Object(c.featureIsEnabled)("answers_hotels")&&o.createElement(x,null))}))},A=n("@ta/failover.readonly"),j=n("@ta/overlays.popover"),U=n.n(j),S=n("@ta/styleguide.button"),z=n.n(S),P=n("@ta/hotels.question-answer-parts"),q=n("@ta/overlays.managers"),D=n("@ta/common.radio"),H=n.n(D),Q=Object(k.connect)(function(e){return{cookieDomain:e.meta.cookieDomain}})(function e(t){var n=function e(t){return t?Object(p.localize)("hotel.review.finish.review_fffff216"):Object(p.localize)("hr_write_a_review")},a={Reviews:function e(){return o.createElement(_,null,function(e){var a=e.writeUserReviewUrl;return o.createElement(w.DraftReviewConsumer,null,function(e){var i=e.hasDraftReview;return o.createElement(y,{locationId:t.locationId,geoId:t.geoId,writeUserReviewUrl:a,pid:40537,className:"ui_button primary",onClick:function e(t){Object(h.trackClick)(t,{module:"content_submission|review",action:"start_submission",context:"POI|Hotel",dstServlet:"UserReviewEdit",value:0,once:!0})}},n(i))})})},Photos:function e(){return o.createElement(z.a,{type:"primary",onClick:function e(n){return O(n,t.geoId,t.locationId,"content_submission|photo",40537,t.cookieDomain)}},Object(p.localize)("hr_post_a_photo"))},Questions:function e(){return Object(c.featureIsEnabled)("answers_hotels")?o.createElement(q.Opener,{name:ke},function(e){return o.createElement(P.AuthGated,{call:e},function(e){return o.createElement(z.a,{type:"primary",onClick:function t(){H()("hr-community-tab").emit("selectTab","Questions",!0),e(),C()({module:"content_submission|question",action:"start_submission",context:"POI|Hotel",value:0,once:!0})}},Object(p.localize)("hr_ask_a_question"))})}):null}},i={Reviews:function e(){return o.createElement(_,null,function(e){var a=e.writeUserReviewUrl;return o.createElement(w.DraftReviewConsumer,null,function(e){var i=e.hasDraftReview;return o.createElement(y,{locationId:t.locationId,geoId:t.geoId,writeUserReviewUrl:a,pid:40537,className:"hotels-community-content-common-ContextualCTA__option--zhK3I",onClick:function e(t){Object(h.trackClick)(t,{module:"contextual_cta_dropdown_review",action:"start_submission",context:"POI|Hotel",dstServlet:"UserReviewEdit",value:0,once:!0})}},o.createElement(g.Icon,{name:"pencil-paper",className:"hotels-community-content-common-ContextualCTA__icon--1rqtt"}),o.createElement("span",{className:"hotels-community-content-common-ContextualCTA__linkText--3zIxv"},n(i)))})})},Photos:function e(){return o.createElement("span",{className:"hotels-community-content-common-ContextualCTA__option--zhK3I",onClick:function e(n){return O(n,t.geoId,t.locationId,"contextual_cta_dropdown_photo",40537,t.cookieDomain)}},o.createElement(g.Icon,{name:"camera-fill",className:"hotels-community-content-common-ContextualCTA__icon--1rqtt"}),o.createElement("span",{className:"hotels-community-content-common-ContextualCTA__linkText--3zIxv"},Object(p.localize)("hr_post_a_photo")))},Questions:function e(){return Object(c.featureIsEnabled)("answers_hotels")?o.createElement(q.Opener,{name:ke},function(e){return o.createElement(P.AuthGated,{call:e},function(e){return o.createElement("span",{className:"hotels-community-content-common-ContextualCTA__option--zhK3I",onClick:function t(){H()("hr-community-tab").emit("selectTab","Questions",!0),e(),C()({module:"contextual_cta_dropdown_question",action:"start_submission",context:"POI|Hotel",value:0,once:!0})}},o.createElement(g.Icon,{name:"forums",className:"hotels-community-content-common-ContextualCTA__icon--1rqtt"}),o.createElement("span",{className:"hotels-community-content-common-ContextualCTA__linkText--3zIxv"},Object(p.localize)("hr_ask_a_question")))})}):null}},l=function e(t){var n=t.selectedTab,i=n&&"RoomTips"!==n&&a[n]||a.Reviews;return o.createElement("div",{className:"hotels-community-content-common-ContextualCTA__currentOption--3Wd5D"},o.createElement(i))},r=function e(t){var n=t.locationId;return o.createElement("a",{href:"/ManagementCenter-d".concat(n),className:"ui_button primary",onClick:function e(t){Object(h.trackClick)(t,{module:"owner_cta",action:"owner_visit_mc_middle",context:n.toString(),value:0,once:!0})}},Object(p.localize)("restaurant_owners_visit_your_owner_mangement_center"))},s=function e(){return o.createElement(U.a,{below:!0,fullBleed:!0,local:!0,arrowType:"none",closeButton:!1,alignEdge:"right",contents:function e(t){return Object.keys(i).map(function(e){return o.createElement(i[e],{close:t,key:e})})}},function(e,t,n,a){return o.createElement("div",{ref:e,className:"hotels-community-content-common-ContextualCTA__dropdownArrow--knz7a",onClick:function e(o){o.stopPropagation(),(a?n:t)(),C()({module:"contextual_cta_dropdown_toggle",action:"open",context:"POI|Hotel",value:0,once:!0})}},o.createElement(g.Icon,{name:a?"caret-up":"caret-down"}))})};return o.createElement(A.HideOnReadonly,null,o.createElement(_,null,function(e){var n=e.loading,a=e.hasNoContent,i=e.isActiveOwner;return n||a?null:i?o.createElement(r,{locationId:t.locationId}):o.createElement("div",{className:"hotels-community-content-common-ContextualCTA__wrapper--1QPc2"},o.createElement("div",{className:"hotels-community-content-common-ContextualCTA__contextualCTA--3K7gq","data-test-target":"ugc_cta_button"},o.createElement(l,{selectedTab:t.selectedTab}),o.createElement(s,null)))}))}),F=n("@ta/common.api"),L=n("@ta/styleguide.grouping-tabs"),B=n("@ta/hotels.review-list-parts"),M=function e(){return o.createElement(_,null,function(e){var t=e.topicsUrl,n=e.questionsCount;return n>3?o.createElement("a",{href:t,target:"_blank",className:"hotels-community-content-common-SeeAllQuestionsLink__see_all_link--109hE"},Object(p.localize)("qa_see_all_n_questions",{nQuestions:n})):null})},V=n("@babel/runtime/helpers/esm/extends"),G=n.n(V),W=n("@babel/runtime/helpers/esm/objectSpread"),K=n.n(W),$=n("@babel/runtime/helpers/esm/classCallCheck"),J=n.n($),X=n("@babel/runtime/helpers/esm/createClass"),Y=n.n(X),Z=n("@babel/runtime/helpers/esm/possibleConstructorReturn"),ee=n.n(Z),te=n("@babel/runtime/helpers/esm/getPrototypeOf"),ne=n.n(te),oe=n("@babel/runtime/helpers/esm/inherits"),ae=n.n(oe),ie=n("@babel/runtime/helpers/esm/assertThisInitialized"),ce=n.n(ie),le=n("@babel/runtime/helpers/esm/defineProperty"),re=n.n(le),se=n("@ta/styleguide.skeleton"),ue=n.n(se),me="hotels-community-content-common-TabBar__tabCount--1vwdQ",de="hotels-community-content-common-TabBar__typeText--3kWRj",_e=new Set(["Questions","RoomTips"]),be=function(e){function t(){var e,n;J()(this,t);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=ee()(this,(e=ne()(t)).call.apply(e,[this].concat(a))),re()(ce()(ce()(n)),"state",{defaultTabCheckCompleted:!1}),n}return ae()(t,e),Y()(t,[{key:"componentDidUpdate",value:function e(){this.state.defaultTabCheckCompleted||this.defaultTabCheck()}},{key:"defaultTabCheck",value:function e(){var t=this.props.context,n=t.loading,o=t.hasNoContent,a=t.questionsCount,i=t.reviewsCount;n||(this.setState({defaultTabCheckCompleted:!0}),!o&&0===i&&a>0&&this.props.setSelectedTab("Questions"))}},{key:"render",value:function e(){var t=this.props.context,n=t.loading,a=t.hasNoContent,i=t.questionsCount,l=t.reviewsCount,r=t.roomTipsCount,s=this.props,u=s.selectedTab,m=s.children;if(a)return null;if(n)return o.createElement(ue.a,{height:"120px"});var d={selectedTab:u},_=[K()({tab:"Reviews",icon:"pencil-paper",count:l,label:Object(p.localize)("hr_community_tab_reviews",{countClass:me,typeClass:de,count:p.globalize.formatNumber("integer",l)})},d),K()({tab:"Questions",icon:"forums",count:i,label:Object(p.localize)("hr_community_tab_questions_2",{countClass:me,typeClass:de,count:p.globalize.formatNumber("integer",i)})},d),K()({tab:"RoomTips",icon:"lightbulb-on",count:r,label:Object(p.localize)("hr_community_tab_room_tips",{countClass:me,typeClass:de,count:p.globalize.formatNumber("integer",r)})},d)];return m(Object(c.featureIsEnabled)("answers_hotels")?_:_.filter(function(e){return"Questions"!==e.tab}))}}]),t}(o.Component),ve=function e(t){return o.createElement(_,null,function(e){return o.createElement(be,G()({},t,{context:e}),t.children)})},fe=function e(t){switch(t){case"Reviews":return Object(p.localize)("common_Reviews");case"Questions":return Object(p.localize)("mobile_questions_answers");case"RoomTips":return Object(p.localize)("tabs_room_tips_title_fffff661");default:return""}},pe=function e(t,n){return[Object(B.createConnectionReviewsQuery)(t,n),v(n)]},he=Object(F.bind)(function(e,t){return B.SensitiveIssuesBadge.stage(e,t),function(e,t){return t}})(function e(t){return o.createElement(f,{locationId:t.locationId},o.createElement(l.Section,{section:"reviews",theme:"none"},o.createElement(L.GroupingTabs,null,o.createElement(ve,t,function(e){return e.map(function(e){return o.createElement(L.GroupingTab,{active:e.tab===t.selectedTab,key:e.tab,onClick:e.count>0?function(){return t.setSelectedTab(e.tab,!0)}:function(){return!1},className:"".concat("hotels-community-content-common-TabAboveHeader__tab--2IBb2"," test-target-tab-").concat(e.tab)},o.createElement(g.Icon,{name:e.icon,className:i()("hotels-community-content-common-TabAboveHeader__icon--z0-Ex",e.count>0?null:"hotels-community-content-common-TabAboveHeader__inactive--a3nEx")}),Object(p.unescaped)(e.label,e.count>0?"":"hotels-community-content-common-TabAboveHeader__inactive--a3nEx"))})}))),o.createElement(l.Section,{theme:"tabbed-top",joinable:!_e.has(t.selectedTab)},o.createElement(l.ComplexHeader,{text:o.createElement(o.Fragment,null,fe(t.selectedTab),"Reviews"===t.selectedTab?o.createElement(B.ReviewControlNotice,null):null,"Questions"===t.selectedTab?o.createElement(M,null):null),noDivider:_e.has(t.selectedTab)},"Reviews"===t.selectedTab?o.createElement(B.PointsCampaign,{locationId:t.locationId}):null,o.createElement(Q,{selectedTab:t.selectedTab,locationId:t.locationId,geoId:t.geoId})),o.createElement(B.SensitiveIssuesBadge,null),"Reviews"===t.selectedTab?o.createElement(B.ConnectionReviewsCTA,{locationId:t.locationId}):null))});n.d(t,"HEADER_SCROLL_OFFSET",function(){return Ce}),n.d(t,"H_R_CONTENT_COLLECTION_PID",function(){return we}),n.d(t,"QUESTION_FORM_MODAL_NAME",function(){return ke}),n.d(t,"scrollIntoView",function(){return Ee}),n.d(t,"LowContentCTA",function(){return R}),n.d(t,"ContextualCTA",function(){return Q}),n.d(t,"TabBarAboveHeader",function(){return he}),n.d(t,"createTabBarQueries",function(){return pe});var Ce=66,we=40537,ke="community_qa_question_form",Ee=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=document.querySelector("#REVIEWS"),o=document.querySelector("body");if(o&&n){var a=o.getBoundingClientRect().top;window.scrollTo(0,n.getBoundingClientRect().top-a-t)}};t.default={}}}});
//# sourceMappingURL=hotels.community-content-common.5bcd366a52.js.map