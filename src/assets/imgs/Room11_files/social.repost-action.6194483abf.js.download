($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/social.repost-action",d:["vendor-babel","vendor-react-libs","vendor-redux-libs","vendor-apollo-libs","lithium-platform","@ta/common.webview","@ta/overlays.managers","@ta/social.feed","@ta/social.login-gate","@ta/social.onboarding-state","ta-common","@ta/tracking.interactions","@ta/social.blocks","ta-platform","@ta/overlays.toast"],e:["./packages/social/repost-action/repost-action.jsx"],x:{"./packages/social/repost-action/repost-action.jsx":["default","RepostAction"]},m:{"./packages/social/repost-action/repost-action.jsx":function(e,t,o){"use strict";o.r(t);var s=o("@babel/runtime/helpers/esm/extends"),r=o.n(s),a=o("@babel/runtime/helpers/esm/objectSpread"),n=o.n(a),i=o("@babel/runtime/helpers/esm/classCallCheck"),c=o.n(i),l=o("@babel/runtime/helpers/esm/createClass"),p=o.n(l),u=o("@babel/runtime/helpers/esm/possibleConstructorReturn"),m=o.n(u),d=o("@babel/runtime/helpers/esm/getPrototypeOf"),b=o.n(d),h=o("@babel/runtime/helpers/esm/inherits"),f=o.n(h),v=o("@babel/runtime/helpers/esm/assertThisInitialized"),_=o.n(v),g=o("@babel/runtime/helpers/esm/defineProperty"),P=o.n(g),k=o("react"),y=o("react-redux"),O=o("react-apollo"),j=o("@ta/common.classnames"),I=o.n(j),w=o("@ta/common.features"),T=o("@ta/common.i18n"),A=o("@ta/common.webview"),C=o("@ta/overlays.managers"),E=o("@ta/platform.import"),R=o("@ta/social.feed"),S=o("@ta/social.login-gate"),z=o("@ta/social.onboarding-state"),U=o("@ta/styleguide.icon"),M=o("@ta/tracking.interactions"),N=o("@ta/social.blocks"),x=o("@ta/common.routing"),F=o("@ta/overlays.toast"),L=function(e){function t(){var e,o;c()(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return o=m()(this,(e=b()(t)).call.apply(e,[this].concat(r))),P()(_()(_()(o)),"successToastMessage",{Review:Object(T.localize)("success_repost_review"),Photo:Object(T.localize)("success_repost_photo"),Video:Object(T.localize)("success_repost_video"),ForumPost:Object(T.localize)("success_repost_forum"),LinkPost:Object(T.localize)("success_repost_link"),Trip:Object(T.localize)("success_repost_trip"),MediaBatch:Object(T.localize)("success_repost_photos")}),o}return f()(t,e),p()(t,[{key:"createToast",value:function e(t,o,s){switch(o){case"success":return{node:this.successToastMessage[t],cta:k.createElement(x.Link,{href:s?"/Profile/".concat(s):"/Profile",to:{page:"Profile",username:s}},Object(T.localize)("view_repost"))};case"error":return{node:Object(T.localize)("repost_failure_message")};case"rate_limited":return{node:Object(T.localize)("repost_rate_limited_v2")};case"no_permission":return{node:k.createElement(N.NoPermissionToast,null)};default:return{node:""}}}},{key:"render",value:function e(){var t=this;return k.createElement(F.Toaster,null,function(e){return t.props.children(function(o,s,r){e(t.createToast(o,s,r))})})}}]),t}(k.Component),B=Object(E.deferredImport)("@ta/social.repost-uploader","RepostUploader"),W=function(e){function t(){var e,o;c()(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return o=m()(this,(e=b()(t)).call.apply(e,[this].concat(r))),P()(_()(_()(o)),"state",{loadModal:!1}),P()(_()(_()(o)),"repostToast",void 0),P()(_()(_()(o)),"repostCallback",function(e,t,s){o.repostToast&&o.repostToast(e,t,s),"success"===t&&o.props.attemptOnboarding&&o.props.setFireOnboarding(!1,"REPOST_ACTION")}),P()(_()(_()(o)),"checkPermissionForUser",function(e){if(e&&e.blockStatus){var t=e.blockStatus;if(t&&(t.isBlocking||t.isBlockingYou))return!1}return!0}),P()(_()(_()(o)),"checkPermissions",function(){return!(!o.checkPermissionForUser(o.props.actor)||o.props.repostPreviewProps&&!o.checkPermissionForUser(o.props.repostPreviewProps.actor))||("function"==typeof o.repostToast&&o.repostToast(o.props.repostPreviewProps.feedSectionItem.object.__typename,"no_permission"),!1)}),P()(_()(_()(o)),"name","RepostUploader:".concat(Math.random())),o}return f()(t,e),p()(t,[{key:"createRepostUploader",value:function e(){var t=this;if(!this.props.repostPreviewProps.member&&this.props.loggedInUserId){var o=[{id:this.props.loggedInUserId}];return k.createElement(O.Query,{query:R.ProfileQueryWithUserId,variables:{userIds:o},errorPolicy:"all"},function(e){var o=(e.data||{}).memberProfiles,s=void 0===o?null:o,a=s?s[0]:null,i=n()({},t.props),c=n()({},t.props.repostPreviewProps);return c.member=a,i.repostPreviewProps=c,k.createElement(B,r()({},i,{modalName:t.name,repostCallback:t.repostCallback}))})}return k.createElement(B,r()({},this.props,{modalName:this.name,repostCallback:this.repostCallback}))}},{key:"render",value:function e(){var t=this,o=this.props.socialStatistics&&this.props.socialStatistics.isReposted,s=this.props.repostPreviewProps.feedSectionItem.object.id,r=this.props.repostPreviewProps.feedSectionItem.object.__typename,a=this.props,n=a.styleAsShareListItem,i=a.openRepostModalAsLocal,c=k.createElement(k.Fragment,null,k.createElement(S.SocialLoginGate,{pid:40434},function(e){return k.createElement(C.Opener,{name:t.name,local:i},function(a){return k.createElement(M.InteractionLogger,null,function(i){return k.createElement("span",{onClick:function o(n){t.state.loadModal||t.setState({loadModal:!0}),t.props.onClick&&t.props.onClick(),A.NativeBridge.isNativeWebview()?s&&r&&A.NativeBridge.postToBridge("repost",1,{objectId:s,type:r}):(i(n,"repost"),e().then(t.checkPermissions).then(function(e){e&&a()}))},className:I()(n?"social-repost-action-RepostAction__share_list_item--vAYKd":"social-repost-action-RepostAction__social_action--2Msgl",P()({},"social-repost-action-RepostAction__active--3uYgW",o))},k.createElement(U.Icon,{name:"repost",className:"social-repost-action-RepostAction__icon--2iAxG"}),k.createElement("span",{className:"ui_link ".concat("social-repost-action-RepostAction__text--3GPHP"," socialCTA")},o?Object(T.localize)("reposted"):n?Object(T.localize)("social_repost_on_tripadvisor"):Object(T.localize)("social_repost")))})})}),this.state.loadModal?this.createRepostUploader():null,k.createElement(L,null,function(e){t.repostToast=e}));return k.createElement(k.Fragment,null,Object(w.featureIsEnabled)("social_reposts")?c:null)}}]),t}(k.Component);P()(W,"defaultProps",{onClick:void 0,attemptOnboarding:!0,styleAsShareListItem:!1,openRepostModalAsLocal:!1});var G=Object(y.connect)(function(e){return{loggedInUserId:e.auth.loggedInUserId}},{setFireOnboarding:z.ACTIONS.setShouldFire})(W);o.d(t,"RepostAction",function(){return G}),t.default={}}}});
//# sourceMappingURL=social.repost-action.6194483abf.js.map