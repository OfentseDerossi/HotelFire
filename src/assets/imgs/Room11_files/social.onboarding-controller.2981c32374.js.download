($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/social.onboarding-controller",d:["vendor-babel","vendor-react-libs","vendor-apollo-libs","ta-platform","@ta/common.localstorage","lithium-platform","@ta/social.educational-tooltips","@ta/social.onboarding-state","@ta/social.onboarding-utils","@ta/overlays.modal","ta-common"],e:["./packages/social/onboarding-controller/OnboardingController.jsx"],x:{"./packages/social/feed/feedFragments/HometownFields.fragment.gql":["a"],"./packages/social/onboarding-controller/OnboardingController.jsx":["OnboardingController","default"]},m:{"./packages/social/feed/feedFragments/HometownFields.fragment.gql":function(e,n,i){"use strict";var a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"HometownFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MemberLocation"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fallbackString"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"location"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additionalNames"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"long"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"parent"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:203}};a.loc.source={body:"cd3d893a1d20"},n.a=a},"./packages/social/onboarding-controller/OnboardingController.jsx":function(e,n,i){"use strict";i.r(n);var a=i("@babel/runtime/helpers/esm/classCallCheck"),t=i.n(a),o=i("@babel/runtime/helpers/esm/createClass"),r=i.n(o),l=i("@babel/runtime/helpers/esm/possibleConstructorReturn"),d=i.n(l),s=i("@babel/runtime/helpers/esm/getPrototypeOf"),m=i.n(s),c=i("@babel/runtime/helpers/esm/inherits"),u=i.n(c),g=i("@babel/runtime/helpers/esm/assertThisInitialized"),k=i.n(g),v=i("@babel/runtime/helpers/esm/defineProperty"),p=i.n(v),b=i("react"),f=i("react-apollo"),S=i("@ta/common.api"),F=i("@ta/common.tracking"),h=i.n(F),N=i("@ta/common.localstorage"),_=i.n(N),y=i("@ta/events.window-scroll"),O=i.n(y),I=i("@ta/common.features"),w=i("@ta/social.educational-tooltips"),C=i("@ta/social.onboarding-state"),E=i("@ta/social.onboarding-utils"),D=i("@ta/overlays.modal"),P=i("@ta/styleguide.loading"),L=i("@ta/platform.import"),T=i("./packages/social/feed/feedFragments/HometownFields.fragment.gql"),A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"OnboardingProfile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loggedIn"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"memberProfiles"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userIds"},value:{kind:"ListValue",values:[{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}]}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"avatar"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hometown"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HometownFields"},directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"myExternallyConnectedAccountTypes"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"loggedIn"}}}]}]},{kind:"Field",name:{kind:"Name",value:"insightProfile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uiCardsState"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"states"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:533}};A.loc.source={body:"db3c37e81623"};var H={};A.definitions=A.definitions.concat(function M(e){return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!H[n]&&(H[n]=!0,!0)})}(T.a.definitions));var R=A;i.d(n,"OnboardingController",function(){return V});var U,j=L.component.onUsage(((U=function e(){return i.e("@ta/social.onboarding-modal")}).__PACKAGE__="@ta/social.onboarding-controller",U.__MODULE_ID__="@ta/social.onboarding-modal",U.__MODULE_NAME__="@ta/social.onboarding-modal",U.__BUNDLE_NAME__="@ta/social.onboarding-modal",U.__GET_SYNC__=function(){return i.m["@ta/social.onboarding-modal"]?i("@ta/social.onboarding-modal"):null},U.__IS_LOADED__=function(){return void 0!==i.m["@ta/social.onboarding-modal"]},U),"default",function(e){var n=e.firedFrom;return C.CONFIRM_USERNAME_ENTRYPOINTS.has(n)&&b.createElement(D.ModalView,{isFullBleed:!0},b.createElement("div",{className:"social-onboarding-controller-OnboardingController__wrapper--3lmbe"},b.createElement(P.LoadingSpinner,null)))}),G=null,q=750,x=["MASTHEAD","DEFAULT","BRAND_EDUCATOR","FACEBOOK_ENGAGEMENT_CARD","UNKNOWN"],V=function(e){function n(e){var i;return t()(this,n),i=d()(this,m()(n).call(this,e)),p()(k()(k()(i)),"onFlowEnd",function(e){i.allowsPageRefresh()&&e?(_.a.set(w.OnboardingCompleteReload,!0),window.location.reload()):(i.setState({disabled:!0}),i.props.onboardingDone())}),p()(k()(k()(i)),"onClose",function(){i.setState({disabled:!0}),i.props.onboardingDone()}),p()(k()(k()(i)),"onDisable",function(){return i.setState({disabled:!0})}),p()(k()(k()(i)),"onScroll",function(){G+q<window.pageYOffset&&i.setState({waitForScroll:!1})}),p()(k()(k()(i)),"getFiredFrom",function(){return Object(E.isHomePageMemberGateTest)()&&i.isHome()&&"MOBILE"!==i.props.viewportCategory?Object(E.isHomePageMemberGateRegSplashExpSuasTest)()?"SUAS_REG_SPLASH":Object(E.isHomePageMemberGateRegSplashTest)()?"REGISTRATION_SPLASH":"FULLSCREEN_SPLASH":"DEFAULT"}),p()(k()(k()(i)),"shouldOnboardingBeDisabled",function(){return Object(E.isHomePageMemberGateTest)()?i.userIsLoggedIn():!!Object(E.isOnboardingDisabledThroughFeature)(i.props.entryPoint,i.props.viewportCategory,i.props.servlet)||null!==i.props.cachedCookieFound&&i.props.cachedCookieFound}),p()(k()(k()(i)),"entryPointRequiresScrollToFire",function(){return E.ScrollEntrypoints.includes(i.props.entryPoint)}),p()(k()(k()(i)),"allowsPageRefresh",function(){return i.isHome()&&x.includes(i.state.firedFrom)}),p()(k()(k()(i)),"allowsLaunchOnPageLoad",function(){return i.isHome()}),p()(k()(k()(i)),"isHome",function(){return"Home"===i.props.servlet}),p()(k()(k()(i)),"userIsLoggedIn",function(){return null!==i.props.loggedInUserId}),i.state={disabled:i.shouldOnboardingBeDisabled(),waitForSignal:!i.allowsLaunchOnPageLoad(),waitForScroll:!1,firedFrom:i.getFiredFrom()},i.isHome()&&!i.userIsLoggedIn()&&Object(I.featureIsEnabled)("memx_control")&&h()({module:"homepage_softgate",action:"homepage_softgate_requested"}),i}return u()(n,e),r()(n,[{key:"componentDidMount",value:function e(){this.allowsLaunchOnPageLoad()&&(h()({module:E.trackingModule[this.state.firedFrom],action:"onboarding_onmount",context:this.userIsLoggedIn()?"logged_in":"logged_out"}),this.state.disabled&&h()({module:E.trackingModule[this.state.firedFrom],action:"valuepropscreen_notshown",context:this.userIsLoggedIn()?"logged_in":"logged_out"}))}},{key:"shouldComponentUpdate",value:function e(n){return null===this.props.cachedCookieFound&&n.cachedCookieFound&&this.setState({disabled:!0}),!0}},{key:"componentDidUpdate",value:function e(n){n.shouldFire||!this.props.shouldFire||Object(E.isOnboardingDisabledThroughFeature)(this.props.entryPoint,this.props.viewportCategory,this.props.servlet)||(this.setState({disabled:!1,waitForSignal:!1,waitForScroll:this.entryPointRequiresScrollToFire(),firedFrom:this.props.entryPoint}),this.entryPointRequiresScrollToFire()&&(G=window.pageYOffset))}},{key:"render",value:function e(){var n=this;return b.createElement(f.Query,{query:R,variables:{userId:this.props.loggedInUserId,loggedIn:this.userIsLoggedIn()},errorPolicy:"all"},function(e){var i=e.loading,a=e.data;return n.state.disabled||n.state.waitForSignal||n.props.readOnly||null===n.props.cachedCookieFound?null:n.state.waitForScroll?b.createElement(O.a,{callback:n.onScroll,throttle:600}):b.createElement(j,{firedFrom:n.state.firedFrom,onFlowEnd:n.onFlowEnd,onClose:n.onClose,onDisable:n.onDisable,immediateLoad:n.props.immediateLoad,loading:i,data:a})})}}]),n}(b.Component);n.default=Object(S.bind)({data:function e(n,i){var a=i("/data/1.0/onboarding/shown");return function(){var e=a.get().data;return{loggedInUserId:n.auth.loggedInUserId,viewportCategory:n.meta.device.viewportCategory,shouldFire:Object(C.getState)(n).shouldFire,immediateLoad:Object(C.getState)(n).immediateLoad,entryPoint:Object(C.getState)(n).entryPoint,cachedCookieFound:e?e.seen:null,readOnly:n.meta.readonlyMode,servlet:n.meta.initialServletName}}},actions:{onboardingDone:w.ACTIONS.onboardingDone}})(V)}}});
//# sourceMappingURL=social.onboarding-controller.2981c32374.js.map